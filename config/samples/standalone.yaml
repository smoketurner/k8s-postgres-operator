# Single PostgreSQL server managed by Patroni
# Good for development or small workloads
apiVersion: postgres-operator.smoketurner.com/v1alpha1
kind: PostgresCluster
metadata:
  name: pg-single
  namespace: default
spec:
  version: "16"
  replicas: 1  # Single instance
  storage:
    size: 10Gi
  # TLS is enabled by default; disable for local development
  tls:
    enabled: false
  postgresqlParams:
    max_connections: "200"
    shared_buffers: "256MB"
  # Service configuration for external access (optional)
  # service:
  #   type: LoadBalancer  # or NodePort, ClusterIP (default)
  #   annotations:
  #     service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
  #   loadBalancerSourceRanges:
  #     - "10.0.0.0/8"
  #   externalTrafficPolicy: Local  # preserves client IP
